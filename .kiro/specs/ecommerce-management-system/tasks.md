# 实施计划: 外卖/电商管理系统

## 概述

基于Spring Boot + MyBatis-Plus + Redis + JWT的分层架构实现，严格遵循DTO、VO、POJO的职责分离，通过增量开发方式构建完整的电商管理系统。

## 任务

- [x] 1. 项目初始化和基础配置
  - 创建Spring Boot项目结构
  - 配置Maven依赖（Spring Boot、MyBatis-Plus、Redis、JWT、MySQL）
  - 设置application.yml配置文件
  - 创建基础包结构（controller、service、dao、entity、dto、vo、config、util）
  - _需求: 8.1, 8.2, 8.3_

- [ ] 2. 数据库设计和实体类创建
  - [ ] 2.1 创建数据库表结构
    - 执行SQL脚本创建用户、商品、分类、购物车、订单相关表
    - 设置表索引和外键约束
    - _需求: 8.3_

  - [ ] 2.2 创建POJO实体类
    - 实现User、Product、Category、CartItem、Order、OrderItem实体类
    - 配置MyBatis-Plus注解和字段映射
    - _需求: 8.3_

  - [ ]* 2.3 编写实体类属性测试
    - **属性 15: 缓存过期重新加载**
    - **验证需求: 需求 6.4**

- [ ] 3. 基础配置和工具类实现
  - [ ] 3.1 配置Redis和缓存管理
    - 实现RedisConfig配置类
    - 创建CacheService接口和实现类
    - 配置Redis序列化和连接池
    - _需求: 6.1, 6.2_

  - [ ] 3.2 实现JWT工具类和安全配置
    - 创建JwtUtil工具类（生成、验证、解析JWT）
    - 实现JwtAuthenticationFilter认证过滤器
    - 配置SecurityConfig安全策略
    - _需求: 1.2, 1.3, 7.1_

  - [ ]* 3.3 编写JWT认证属性测试
    - **属性 2: JWT令牌认证有效性**
    - **验证需求: 需求 1.3, 1.4, 7.1**

  - [ ] 3.4 创建通用响应类和异常处理
    - 实现ApiResponse统一响应格式
    - 创建GlobalExceptionHandler全局异常处理器
    - 定义业务异常类（BusinessException等）
    - _需求: 所有需求的错误处理_

- [ ] 4. 用户认证模块实现
  - [ ] 4.1 创建用户相关DTO和VO类
    - 实现UserRegisterDTO、UserLoginDTO、UserProfileVO
    - 添加参数验证注解
    - _需求: 1.1, 1.2, 8.1, 8.2_

  - [ ] 4.2 实现用户DAO层
    - 创建UserMapper接口
    - 实现用户CRUD操作方法
    - _需求: 1.1, 1.2_

  - [ ] 4.3 实现用户Service层
    - 创建UserService接口和实现类
    - 实现用户注册、登录、信息查询逻辑
    - 集成密码加密和JWT生成
    - _需求: 1.1, 1.2, 1.5_

  - [ ]* 4.4 编写用户注册一致性属性测试
    - **属性 1: 用户注册一致性**
    - **验证需求: 需求 1.1, 1.2**

  - [ ] 4.5 实现用户Controller层
    - 创建UserController控制器
    - 实现注册、登录、获取用户信息接口
    - 添加参数验证和权限控制
    - _需求: 1.1, 1.2_

  - [ ]* 4.6 编写登出令牌失效属性测试
    - **属性 3: 登出令牌失效**
    - **验证需求: 需求 1.5**

- [ ] 5. 检查点 - 用户认证功能验证
  - 确保所有测试通过，如有问题请询问用户

- [ ] 6. 商品管理模块实现
  - [ ] 6.1 创建商品相关DTO和VO类
    - 实现ProductQueryDTO、ProductDetailVO、CategoryVO
    - 添加分页和排序参数
    - _需求: 2.1, 2.2, 2.3, 8.1, 8.2_

  - [ ] 6.2 实现商品DAO层
    - 创建ProductMapper和CategoryMapper接口
    - 实现商品查询、搜索、分类管理方法
    - _需求: 2.1, 2.2, 2.3_

  - [ ] 6.3 实现商品Service层
    - 创建ProductService接口和实现类
    - 集成Redis缓存策略
    - 实现商品列表、搜索、详情查询逻辑
    - _需求: 2.1, 2.2, 2.3, 2.4, 2.5_

  - [ ]* 6.4 编写商品搜索准确性属性测试
    - **属性 4: 商品搜索准确性**
    - **验证需求: 需求 2.2**

  - [ ]* 6.5 编写商品缓存一致性属性测试
    - **属性 5: 商品缓存一致性**
    - **验证需求: 需求 2.4, 6.2, 6.3**

  - [ ] 6.6 实现商品Controller层
    - 创建ProductController控制器
    - 实现商品列表、搜索、详情查询接口
    - _需求: 2.1, 2.2, 2.3_

  - [ ]* 6.7 编写缓存优先读取属性测试
    - **属性 6: 缓存优先读取**
    - **验证需求: 需求 2.5, 6.1**

- [ ] 7. 购物车功能实现
  - [ ] 7.1 创建购物车相关DTO和VO类
    - 实现CartItemDTO、CartUpdateDTO、CartVO
    - 添加数量和商品信息验证
    - _需求: 3.1, 3.2, 3.4, 8.1, 8.2_

  - [ ] 7.2 实现购物车DAO层
    - 创建CartItemMapper接口
    - 实现购物车CRUD操作方法
    - _需求: 3.1, 3.2, 3.3, 3.5_

  - [ ] 7.3 实现购物车Service层
    - 创建CartService接口和实现类
    - 实现添加、修改、删除、查询、清空购物车逻辑
    - 集成商品信息和总价计算
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

  - [ ]* 7.4 编写购物车操作一致性属性测试
    - **属性 7: 购物车操作一致性**
    - **验证需求: 需求 3.1, 3.2, 3.3**

  - [ ]* 7.5 编写购物车总价计算正确性属性测试
    - **属性 8: 购物车总价计算正确性**
    - **验证需求: 需求 3.4**

  - [ ] 7.6 实现购物车Controller层
    - 创建CartController控制器
    - 实现购物车管理相关接口
    - 添加用户身份验证
    - _需求: 3.1, 3.2, 3.3, 3.4, 3.5_

  - [ ]* 7.7 编写购物车清空完整性属性测试
    - **属性 9: 购物车清空完整性**
    - **验证需求: 需求 3.5**

- [ ] 8. 订单管理功能实现
  - [ ] 8.1 创建订单相关DTO和VO类
    - 实现OrderCreateDTO、OrderQueryDTO、OrderVO、OrderDetailVO
    - 添加订单状态和分页参数
    - _需求: 4.1, 4.3, 4.4, 8.1, 8.2_

  - [ ] 8.2 实现订单DAO层
    - 创建OrderMapper和OrderItemMapper接口
    - 实现订单CRUD和查询方法
    - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [ ] 8.3 实现订单Service层
    - 创建OrderService接口和实现类
    - 实现订单创建、查询、状态更新逻辑
    - 集成库存检查和购物车清空
    - _需求: 4.1, 4.2, 4.3, 4.4, 4.5_

  - [ ]* 8.4 编写订单创建完整性属性测试
    - **属性 10: 订单创建完整性**
    - **验证需求: 需求 4.1, 4.2**

  - [ ]* 8.5 编写订单查询准确性属性测试
    - **属性 11: 订单查询准确性**
    - **验证需求: 需求 4.3, 4.4**

  - [ ] 8.6 实现订单Controller层
    - 创建OrderController控制器
    - 实现订单创建、查询、详情接口
    - 添加用户权限验证
    - _需求: 4.1, 4.3, 4.4_

  - [ ]* 8.7 编写订单状态更新一致性属性测试
    - **属性 12: 订单状态更新一致性**
    - **验证需求: 需求 4.5**

- [ ] 9. 检查点 - 核心功能验证
  - 确保所有测试通过，如有问题请询问用户

- [ ] 10. 后台管理功能实现
  - [ ] 10.1 实现管理员商品管理Service层
    - 扩展ProductService添加管理员功能
    - 实现商品添加、修改、删除逻辑
    - 集成缓存同步策略
    - _需求: 5.2, 5.3, 5.4_

  - [ ]* 10.2 编写商品管理缓存同步属性测试
    - **属性 14: 商品管理缓存同步**
    - **验证需求: 需求 5.2, 5.3, 5.4**

  - [ ] 10.3 实现管理员Controller层
    - 创建AdminController控制器
    - 实现商品管理和订单管理接口
    - 添加管理员权限验证
    - _需求: 5.1, 5.2, 5.3, 5.4, 5.5_

  - [ ]* 10.4 编写权限控制严格性属性测试
    - **属性 13: 权限控制严格性**
    - **验证需求: 需求 5.1, 7.2, 7.3, 7.4**

- [ ] 11. 系统集成和优化
  - [ ] 11.1 实现缓存预热功能
    - 创建系统启动时的缓存预加载逻辑
    - 实现热门商品和分类信息的预缓存
    - _需求: 6.5_

  - [ ] 11.2 完善异常处理和日志记录
    - 优化全局异常处理器
    - 添加关键操作的日志记录
    - 实现缓存降级策略
    - _需求: 所有需求的异常处理_

  - [ ]* 11.3 编写集成测试
    - 实现端到端的业务流程测试
    - 测试用户注册→登录→购物→下单完整流程
    - _需求: 所有需求的集成验证_

- [ ] 12. 最终检查点 - 系统完整性验证
  - 确保所有测试通过，如有问题请询问用户

## 注意事项

- 标记为 `*` 的任务是可选的，可以跳过以实现更快的MVP
- 每个任务都引用了具体的需求以确保可追溯性
- 检查点确保增量验证
- 属性测试验证通用正确性属性
- 单元测试验证具体示例和边界情况